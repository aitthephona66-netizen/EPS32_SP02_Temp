<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <title>ESP32 MAX30100 BLE Monitor</title>    <meta name="viewport" content="width=device-width, initial-scale=1">    <style>        :root {            --bg-primary: #111;            --bg-secondary: #1e1e1e;            --bg-card: #1e1e1e;            --bg-connected: #24af37;            --bg-disconnected: #d13a30;            --bg-on: #ffaa00;            --bg-off: #666;            --bg-hr: #ff3366;            --bg-spo2: #3366ff;            --bg-temp-c: #ff6b6b;            --bg-temp-f: #4ecdc4;            --text-primary: #fff;            --text-secondary: #aaa;            --text-muted: #888;            --border-radius: 12px;            --transition: all 0.3s ease;            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);        }        * {            box-sizing: border-box;        }        body {            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;            background: var(--bg-primary);            color: var(--text-primary);            margin: 0;            padding: 0;            line-height: 1.6;        }        .topnav {            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);            padding: 20px;            text-align: center;            box-shadow: var(--shadow);            border-bottom: 1px solid rgba(255, 255, 255, 0.05);        }        .topnav h1 {            margin: 0;            font-size: 1.8rem;            font-weight: 600;            background: linear-gradient(90deg, #24af37, #3366ff);            -webkit-background-clip: text;            background-clip: text;            color: transparent;        }        .topnav p {            margin: 10px 0 0;            color: var(--text-secondary);            font-size: 0.9rem;        }        .content {            padding: 20px;            max-width: 1200px;            margin: 0 auto;        }        .card-grid {            display: grid;            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));            gap: 20px;            margin-bottom: 30px;        }        .card {            background: var(--bg-card);            padding: 25px;            border-radius: var(--border-radius);            text-align: center;            box-shadow: var(--shadow);            transition: var(--transition);            border: 1px solid rgba(255, 255, 255, 0.05);        }        .card:hover {            transform: translateY(-3px);            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15);        }        .card h2 {            margin-top: 0;            display: flex;            align-items: center;            justify-content: center;            gap: 10px;            font-size: 1.4rem;        }        button {            padding: 12px 24px;            margin: 5px;            font-size: 16px;            border-radius: var(--border-radius);            border: none;            cursor: pointer;            font-weight: 600;            transition: var(--transition);            min-width: 120px;        }        button:hover {            opacity: 0.9;            transform: translateY(-2px);        }        button:active {            transform: translateY(0);        }        button:disabled {            opacity: 0.5;            cursor: not-allowed;            transform: none;        }        .connectButton {             background: var(--bg-connected);             color: white;         }        .disconnectButton {             background: var(--bg-disconnected);             color: white;         }        .onButton {             background: var(--bg-on);             color: #000;         }        .offButton {             background: var(--bg-off);             color: white;         }        .reading {            font-size: 48px;            font-weight: 700;            margin: 20px 0;            font-family: 'Courier New', monospace;        }        #hrValue {            color: var(--bg-hr);            text-shadow: 0 0 10px rgba(255, 51, 102, 0.3);        }        #spo2Value {            color: var(--bg-spo2);            text-shadow: 0 0 10px rgba(51, 102, 255, 0.3);        }        #tempCValue {            color: var(--bg-temp-c);            text-shadow: 0 0 10px rgba(255, 107, 107, 0.3);        }        #tempFValue {            color: var(--bg-temp-f);            text-shadow: 0 0 10px rgba(78, 205, 196, 0.3);        }        .gray-label {            color: var(--text-secondary);            font-size: 14px;            margin: 5px 0;        }        .status-container {            display: flex;            align-items: center;            justify-content: center;            gap: 10px;            margin-top: 10px;        }        .status-indicator {            width: 12px;            height: 12px;            border-radius: 50%;            display: inline-block;        }        .connected { background-color: var(--bg-connected); }        .disconnected { background-color: var(--bg-disconnected); }        .connection-status {            display: inline-flex;            align-items: center;            gap: 8px;            padding: 6px 12px;            border-radius: 20px;            background: rgba(255, 255, 255, 0.05);            font-size: 0.9rem;        }        .data-container {            display: flex;            flex-direction: column;            align-items: center;        }        .data-history {            display: flex;            gap: 15px;            margin-top: 15px;            flex-wrap: wrap;            justify-content: center;        }        .history-item {            background: rgba(255, 255, 255, 0.05);            padding: 8px 15px;            border-radius: 20px;            font-size: 0.85rem;            color: var(--text-secondary);        }        .history-item span {            color: var(--text-primary);            font-weight: 600;            margin-left: 5px;        }        .led-status {            margin: 20px 0;            font-size: 1.2rem;            display: flex;            align-items: center;            justify-content: center;            gap: 10px;        }        .led-indicator {            width: 20px;            height: 20px;            border-radius: 50%;            background-color: var(--bg-off);            display: inline-block;            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);        }        .led-indicator.on {            background-color: var(--bg-on);            box-shadow: 0 0 15px rgba(255, 170, 0, 0.7);        }        .notification {            position: fixed;            top: 20px;            right: 20px;            padding: 15px 20px;            border-radius: var(--border-radius);            background: var(--bg-secondary);            box-shadow: var(--shadow);            z-index: 1000;            display: flex;            align-items: center;            gap: 10px;            transform: translateX(150%);            transition: transform 0.5s ease;            max-width: 350px;        }        .notification.show {            transform: translateX(0);        }        .notification.success {            border-left: 5px solid var(--bg-connected);        }        .notification.error {            border-left: 5px solid var(--bg-disconnected);        }        .notification.warning {            border-left: 5px solid var(--bg-on);        }        .notification-icon {            font-size: 1.5rem;        }        .notification-content {            flex: 1;        }        .notification-content p {            margin: 0;        }        .notification-title {            font-weight: 600;            margin-bottom: 5px;        }        .notification-close {            background: transparent;            border: none;            color: var(--text-secondary);            font-size: 1.2rem;            cursor: pointer;            padding: 0;            min-width: auto;        }        .chart-container {            margin-top: 20px;            height: 200px;            width: 100%;        }        /* New styles for temperature layout */        .temperature-grid {            display: grid;            grid-template-columns: 1fr 1fr;            gap: 20px;            margin-top: 10px;        }        .temperature-item {            background: rgba(255, 255, 255, 0.05);            padding: 15px;            border-radius: var(--border-radius);            text-align: center;        }        .temperature-reading {            font-size: 32px;            font-weight: 700;            margin: 10px 0;            font-family: 'Courier New', monospace;        }        .temp-label {            font-size: 0.9rem;            color: var(--text-secondary);            margin-bottom: 5px;        }        @media (max-width: 768px) {            .card-grid {                grid-template-columns: 1fr;            }                        .content {                padding: 15px;            }                        .reading {                font-size: 40px;            }                        .temperature-reading {                font-size: 28px;            }                        button {                min-width: 100px;                padding: 10px 20px;            }                        .temperature-grid {                grid-template-columns: 1fr;                gap: 15px;            }        }    </style></head><body><div class="topnav">    <h1>ESP32 MAX30100 BLE Monitor</h1>    <p>Real-time heart rate, SpO‚ÇÇ and temperature monitoring via Web Bluetooth</p></div><div class="content">    <!-- Connection Status -->    <div class="card-grid">        <div class="card">            <h2>üîó Device Connection</h2>            <div class="status-container">                <div class="connection-status">                    <div class="status-indicator disconnected" id="statusIndicator"></div>                    <span id="bleState">Disconnected</span>                </div>            </div>            <div style="margin-top: 20px;">                <button id="connectBleButton" class="connectButton">Connect to Device</button>                <button id="disconnectBleButton" class="disconnectButton" disabled>Disconnect</button>            </div>            <p class="gray-label" style="margin-top: 15px;">                Device: <strong><span id="deviceName">ESP32Banana</span></strong>            </p>        </div>    </div>    <!-- Sensor Data -->    <div class="card-grid">        <div class="card">            <h2>‚ù§Ô∏è Heart Rate</h2>            <div class="data-container">                <p class="reading"><span id="hrValue">--</span> bpm</p>                <div class="data-history">                    <div class="history-item">Min: <span id="hrMin">--</span></div>                    <div class="history-item">Max: <span id="hrMax">--</span></div>                    <div class="history-item">Avg: <span id="hrAvg">--</span></div>                </div>            </div>        </div>        <div class="card">            <h2>ü©∏ Blood Oxygen (SpO‚ÇÇ)</h2>            <div class="data-container">                <p class="reading"><span id="spo2Value">--</span> %</p>                <div class="data-history">                    <div class="history-item">Min: <span id="spo2Min">--</span></div>                    <div class="history-item">Max: <span id="spo2Max">--</span></div>                    <div class="history-item">Avg: <span id="spo2Avg">--</span></div>                </div>            </div>        </div>    </div>    <!-- Temperature Data -->    <div class="card-grid">        <div class="card">            <h2>üå°Ô∏è Temperature</h2>            <div class="data-container">                <div class="temperature-grid">                    <div class="temperature-item">                        <div class="temp-label">Temperature (¬∞C)</div>                        <p class="temperature-reading"><span id="tempCValue">--</span> ¬∞C</p>                        <div class="data-history">                            <div class="history-item">Min: <span id="tempCMin">--</span></div>                            <div class="history-item">Max: <span id="tempCMax">--</span></div>                            <div class="history-item">Avg: <span id="tempCAvg">--</span></div>                        </div>                    </div>                                        <div class="temperature-item">                        <div class="temp-label">Temperature (¬∞F)</div>                        <p class="temperature-reading"><span id="tempFValue">--</span> ¬∞F</p>                        <div class="data-history">                            <div class="history-item">Min: <span id="tempFMin">--</span></div>                            <div class="history-item">Max: <span id="tempFMax">--</span></div>                            <div class="history-item">Avg: <span id="tempFAvg">--</span></div>                        </div>                    </div>                </div>            </div>        </div>    </div>    <!-- LED Control & Timestamp -->    <div class="card-grid">        <div class="card">            <h2>üí° LED Control</h2>            <div class="led-status">                Status:                 <div class="led-indicator" id="ledIndicator"></div>                <span id="ledText">OFF</span>            </div>            <div>                <button id="onButton" class="onButton" disabled>Turn ON</button>                <button id="offButton" class="offButton" disabled>Turn OFF</button>            </div>            <p class="gray-label" style="margin-top: 20px;">                Last value sent: <span id="valueSent">-</span>            </p>        </div>                <div class="card">            <h2>üìä Data Information</h2>            <div class="data-container">                <p class="gray-label" style="font-size: 1.1rem; margin-bottom: 10px;">                    Last update:                </p>                <p id="timestamp" style="font-size: 1.2rem; font-weight: 600; margin: 10px 0;">                    --                </p>                <div class="data-history">                    <div class="history-item">Updates: <span id="updateCount">0</span></div>                    <div class="history-item">Connected: <span id="connectionTime">00:00</span></div>                </div>            </div>        </div>    </div></div><!-- Notification Container --><div id="notificationContainer"></div><script>/* ================= DOM Elements ================= */const connectButton = document.getElementById('connectBleButton');const disconnectButton = document.getElementById('disconnectBleButton');const onButton = document.getElementById('onButton');const offButton = document.getElementById('offButton');const bleStateContainer = document.getElementById('bleState');const statusIndicator = document.getElementById('statusIndicator');const hrValue = document.getElementById('hrValue');const spo2Value = document.getElementById('spo2Value');const tempCValue = document.getElementById('tempCValue');const tempFValue = document.getElementById('tempFValue');const timestampContainer = document.getElementById('timestamp');const latestValueSent = document.getElementById('valueSent');const deviceNameElement = document.getElementById('deviceName');const ledIndicator = document.getElementById('ledIndicator');const ledText = document.getElementById('ledText');// Data history elementsconst hrMin = document.getElementById('hrMin');const hrMax = document.getElementById('hrMax');const hrAvg = document.getElementById('hrAvg');const spo2Min = document.getElementById('spo2Min');const spo2Max = document.getElementById('spo2Max');const spo2Avg = document.getElementById('spo2Avg');const tempCMin = document.getElementById('tempCMin');const tempCMax = document.getElementById('tempCMax');const tempCAvg = document.getElementById('tempCAvg');const tempFMin = document.getElementById('tempFMin');const tempFMax = document.getElementById('tempFMax');const tempFAvg = document.getElementById('tempFAvg');const updateCountElement = document.getElementById('updateCount');const connectionTimeElement = document.getElementById('connectionTime');/* ================= BLE Configuration ================= */const deviceName = 'ESP32Banana';const bleService = '19b10000-e8f2-537e-4f6c-d104768a1214';const ledCharacteristic = '19b10001-e8f2-537e-4f6c-d104768a1214';const sensorCharacteristic = '19b10002-e8f2-537e-4f6c-d104768a1214';/* ================= Global Variables ================= */let bleServer = null;let bleServiceFound = null;let sensorCharacteristicFound = null;let deviceConnected = null;// Data trackinglet hrHistory = [];let spo2History = [];let tempCHistory = [];let tempFHistory = [];let updateCount = 0;let connectionStartTime = null;let connectionTimer = null;/* ================= Event Listeners ================= */connectButton.onclick = connectToDevice;disconnectButton.onclick = disconnectDevice;onButton.onclick = () => writeOnCharacteristic(1);offButton.onclick = () => writeOnCharacteristic(0);/* ================= Helper Functions ================= */// Show notificationfunction showNotification(type, title, message, duration = 5000) {    const notificationContainer = document.getElementById('notificationContainer');        const notification = document.createElement('div');    notification.className = `notification ${type}`;        const icons = {        success: '‚úÖ',        error: '‚ùå',        warning: '‚ö†Ô∏è'    };        notification.innerHTML = `        <div class="notification-icon">${icons[type] || '‚ÑπÔ∏è'}</div>        <div class="notification-content">            <p class="notification-title">${title}</p>            <p>${message}</p>        </div>        <button class="notification-close" onclick="this.parentElement.classList.remove('show')">√ó</button>    `;        notificationContainer.appendChild(notification);        // Trigger animation    setTimeout(() => notification.classList.add('show'), 10);        // Auto remove after duration    if (duration > 0) {        setTimeout(() => {            notification.classList.remove('show');            setTimeout(() => {                if (notification.parentNode) {                    notification.parentNode.removeChild(notification);                }            }, 500);        }, duration);    }}// Update UI statefunction updateConnectionState(connected) {    if (connected) {        bleStateContainer.textContent = "Connected";        statusIndicator.className = "status-indicator connected";        connectButton.disabled = true;        disconnectButton.disabled = false;        onButton.disabled = false;        offButton.disabled = false;    } else {        bleStateContainer.textContent = "Disconnected";        statusIndicator.className = "status-indicator disconnected";        connectButton.disabled = false;        disconnectButton.disabled = true;        onButton.disabled = true;        offButton.disabled = true;                // Reset data display        hrValue.textContent = "--";        spo2Value.textContent = "--";        tempCValue.textContent = "--";        tempFValue.textContent = "--";        timestampContainer.textContent = "--";                // Stop connection timer        if (connectionTimer) {            clearInterval(connectionTimer);            connectionTimer = null;        }    }}// Update data historyfunction updateDataHistory(hr, spo2, tempC, tempF) {    // Add to history (keep last 100 readings)    if (hr !== "--") {        hrHistory.push(parseInt(hr));        if (hrHistory.length > 100) hrHistory.shift();    }        if (spo2 !== "--") {        spo2History.push(parseInt(spo2));        if (spo2History.length > 100) spo2History.shift();    }        if (tempC !== "--" && tempC !== "NAN") {        tempCHistory.push(parseFloat(tempC));        if (tempCHistory.length > 100) tempCHistory.shift();    }        if (tempF !== "--" && tempF !== "NAN") {        tempFHistory.push(parseFloat(tempF));        if (tempFHistory.length > 100) tempFHistory.shift();    }        // Calculate statistics for HR    if (hrHistory.length > 0) {        hrMin.textContent = Math.min(...hrHistory);        hrMax.textContent = Math.max(...hrHistory);        hrAvg.textContent = Math.round(hrHistory.reduce((a, b) => a + b) / hrHistory.length);    }        // Calculate statistics for SpO2    if (spo2History.length > 0) {        spo2Min.textContent = Math.min(...spo2History);        spo2Max.textContent = Math.max(...spo2History);        spo2Avg.textContent = Math.round(spo2History.reduce((a, b) => a + b) / spo2History.length);    }        // Calculate statistics for Temperature Celsius    if (tempCHistory.length > 0) {        tempCMin.textContent = Math.min(...tempCHistory).toFixed(1);        tempCMax.textContent = Math.max(...tempCHistory).toFixed(1);        tempCAvg.textContent = (tempCHistory.reduce((a, b) => a + b) / tempCHistory.length).toFixed(1);    }        // Calculate statistics for Temperature Fahrenheit    if (tempFHistory.length > 0) {        tempFMin.textContent = Math.min(...tempFHistory).toFixed(1);        tempFMax.textContent = Math.max(...tempFHistory).toFixed(1);        tempFAvg.textContent = (tempFHistory.reduce((a, b) => a + b) / tempFHistory.length).toFixed(1);    }}// Convert Celsius to Fahrenheitfunction celsiusToFahrenheit(celsius) {    return (celsius * 9/5) + 32;}// Update connection timerfunction startConnectionTimer() {    connectionStartTime = new Date();        connectionTimer = setInterval(() => {        const now = new Date();        const diff = Math.floor((now - connectionStartTime) / 1000);        const minutes = Math.floor(diff / 60);        const seconds = diff % 60;                connectionTimeElement.textContent =             `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;    }, 1000);}// Format date timefunction getDateTime() {    const d = new Date();    return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });}/* ================= BLE Functions ================= */function connectToDevice() {    if (!navigator.bluetooth) {        showNotification('error', 'Web Bluetooth Not Supported',             'Your browser does not support Web Bluetooth API. Please use Chrome/Edge on desktop or Android.');        return;    }        showNotification('warning', 'Connecting...', 'Looking for BLE device...', 3000);        navigator.bluetooth.requestDevice({        filters: [{ name: deviceName }],        optionalServices: [bleService]    })    .then(device => {        deviceConnected = device;        deviceNameElement.textContent = device.name || deviceName;                showNotification('success', 'Device Found', `Connecting to ${device.name}...`, 3000);                device.addEventListener('gattservicedisconnected', onDisconnected);        return device.gatt.connect();    })    .then(server => {        bleServer = server;        showNotification('success', 'Connected', 'GATT server connected', 3000);                updateConnectionState(true);        startConnectionTimer();                return bleServer.getPrimaryService(bleService);    })    .then(service => {        bleServiceFound = service;                // Get LED characteristic first to control LED        return service.getCharacteristic(ledCharacteristic);    })    .then(char => {        // Initialize LED to OFF        return char.writeValue(new Uint8Array([0]));    })    .then(() => {        // Now get sensor characteristic        return bleServiceFound.getCharacteristic(sensorCharacteristic);    })    .then(characteristic => {        sensorCharacteristicFound = characteristic;                characteristic.addEventListener('characteristicvaluechanged', handleSensorData);        return characteristic.startNotifications();    })    .then(() => {        showNotification('success', 'Ready', 'Receiving sensor data...', 3000);        console.log('BLE Connection established successfully');    })    .catch(error => {        console.error('Connection error:', error);                if (error.name === 'NotFoundError') {            showNotification('error', 'Device Not Found',                 `Could not find device named "${deviceName}". Make sure it's powered on and in range.`);        } else if (error.name === 'SecurityError') {            showNotification('error', 'Security Error',                 'Connection was blocked for security reasons.');        } else if (error.name === 'NetworkError') {            showNotification('error', 'Connection Lost',                 'Connection lost. Please try reconnecting.');        } else {            showNotification('error', 'Connection Failed',                 `Error: ${error.message || 'Unknown error'}`);        }                updateConnectionState(false);    });}function handleSensorData(event) {    const value = new TextDecoder().decode(event.target.value);    // Format from ESP32: "HR,SpO2,TempC,TempF"    const data = value.split(",");        console.log('Received BLE data:', value);        if (data.length >= 4) {        let hr = data[0].trim();        let spo2 = data[1].trim();        let tempC = data[2].trim();        let tempF = data[3].trim();                // Handle NAN values from temperature sensor        if (tempC === "NAN" || tempC === "-999") {            tempC = "--";            tempF = "--";        }                if (hr === "0") hr = "--";        if (spo2 === "0") spo2 = "--";                // Update UI        hrValue.textContent = hr;        spo2Value.textContent = spo2;        tempCValue.textContent = tempC;        tempFValue.textContent = tempF;        timestampContainer.textContent = getDateTime();                // Update history and statistics        if (hr !== "--" && spo2 !== "--") {            updateDataHistory(hr, spo2, tempC, tempF);        }                // Increment update count        updateCount++;        updateCountElement.textContent = updateCount;                // Check for abnormal values        const hrNum = parseInt(hr);        const spo2Num = parseInt(spo2);        const tempCNum = parseFloat(tempC);                if (hrNum > 120 && hrNum <= 250) {            showNotification('warning', 'High Heart Rate',                 `Heart rate is ${hr} bpm. Please rest if needed.`, 5000);        }                if (spo2Num < 95 && spo2Num >= 70) {            showNotification('warning', 'Low Blood Oxygen',                 `SpO‚ÇÇ is ${spo2}%. Ensure proper breathing.`, 5000);        }                if (tempCNum > 37.5 && tempCNum < 100) {            showNotification('warning', 'High Temperature',                 `Body temperature is ${tempC}¬∞C (${tempF}¬∞F). Please monitor your condition.`, 5000);        } else if (tempCNum < 36.0 && tempCNum > 0) {            showNotification('warning', 'Low Temperature',                 `Body temperature is ${tempC}¬∞C (${tempF}¬∞F). Please warm up if needed.`, 5000);        }    } else if (data.length >= 2) {        // Handle old format without temperature        let hr = data[0].trim();        let spo2 = data[1].trim();                if (hr === "0") hr = "--";        if (spo2 === "0") spo2 = "--";                // Update UI for HR and SpO2 only        hrValue.textContent = hr;        spo2Value.textContent = spo2;        timestampContainer.textContent = getDateTime();                // Update history and statistics        if (hr !== "--" && spo2 !== "--") {            updateDataHistory(hr, spo2, "--", "--");        }                // Increment update count        updateCount++;        updateCountElement.textContent = updateCount;                // Check for abnormal values        const hrNum = parseInt(hr);        const spo2Num = parseInt(spo2);                if (hrNum > 120 && hrNum <= 250) {            showNotification('warning', 'High Heart Rate',                 `Heart rate is ${hr} bpm. Please rest if needed.`, 5000);        }                if (spo2Num < 95 && spo2Num >= 70) {            showNotification('warning', 'Low Blood Oxygen',                 `SpO‚ÇÇ is ${spo2}%. Ensure proper breathing.`, 5000);        }    } else {        console.warn('Unexpected data format:', value);    }}function writeOnCharacteristic(value) {    if (!bleServer || !bleServer.connected) {        showNotification('error', 'Not Connected', 'Please connect to the device first.');        return;    }        bleServiceFound.getCharacteristic(ledCharacteristic)    .then(characteristic => {        const data = new Uint8Array([value]);        console.log('Sending LED command:', value);        return characteristic.writeValue(data);    })    .then(() => {        latestValueSent.textContent = value;                // Update LED indicator        if (value === 1) {            ledIndicator.className = "led-indicator on";            ledText.textContent = "ON";            showNotification('success', 'LED On', 'ESP32 LED turned ON', 3000);        } else {            ledIndicator.className = "led-indicator";            ledText.textContent = "OFF";            showNotification('info', 'LED Off', 'ESP32 LED turned OFF', 3000);        }    })    .catch(error => {        console.error('Write error:', error);        showNotification('error', 'Write Failed', 'Failed to send command to device. Please check connection.');    });}function disconnectDevice() {    if (bleServer && bleServer.connected) {        if (sensorCharacteristicFound) {            sensorCharacteristicFound.stopNotifications()            .then(() => bleServer.disconnect())            .then(() => {                onDisconnected();                showNotification('info', 'Disconnected', 'Device disconnected successfully.');            });        } else {            bleServer.disconnect();            onDisconnected();            showNotification('info', 'Disconnected', 'Device disconnected successfully.');        }    } else {        onDisconnected();    }}function onDisconnected() {    updateConnectionState(false);        // Reset data    hrHistory = [];    spo2History = [];    tempCHistory = [];    tempFHistory = [];    updateCount = 0;    updateCountElement.textContent = "0";        // Reset statistics    hrMin.textContent = "--";    hrMax.textContent = "--";    hrAvg.textContent = "--";    spo2Min.textContent = "--";    spo2Max.textContent = "--";    spo2Avg.textContent = "--";    tempCMin.textContent = "--";    tempCMax.textContent = "--";    tempCAvg.textContent = "--";    tempFMin.textContent = "--";    tempFMax.textContent = "--";    tempFAvg.textContent = "--";        // Reset LED indicator    ledIndicator.className = "led-indicator";    ledText.textContent = "OFF";        if (deviceConnected) {        deviceConnected.removeEventListener('gattservicedisconnected', onDisconnected);        deviceConnected = null;    }}/* ================= Initialize ================= */document.addEventListener('DOMContentLoaded', () => {    // Check for Web Bluetooth support    if (!navigator.bluetooth) {        showNotification('error', 'Browser Not Supported',             'Web Bluetooth API is not supported in this browser. Please use Chrome/Edge on desktop or Android.', 0);                connectButton.disabled = true;        connectButton.title = 'Web Bluetooth not supported';    }        // Initialize connection state    updateConnectionState(false);});</script></body></html>